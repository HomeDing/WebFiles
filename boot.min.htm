<!DOCTYPE html><html lang='en'><head><title>Web Update</title></head><body><h1>Web Update</h1><table><tr><td><progress value='0'max='1'></progress></td></tr><tr><td id='info'>.</td></tr><tr><td><button>start</button></td></tr></table><script>var repo="https://homeding.github.io/",eStart=document.querySelector("button"),eBar=document.querySelector("progress"),eInfo=document.querySelector("#info"),work={status:"0",list:null,files:0,done:0},timer=0;function log(e){eInfo.innerText=e}function doStart(){work.status="w";var o=new XMLHttpRequest;o.open("GET",repo+"list.txt",!0),o.responseType="text",o.onload=function(e){var t=o.responseText.replace(/\r?\n/g,";");t=t.replace(/;$/,""),work.list=t.split(";"),work.files=work.list.length,work.status="r"},o.send(null)}function doFile(){work.status="w";var n=work.list.shift();work.done++,eBar.max=work.files,eBar.value=work.done;var s=new XMLHttpRequest;s.open("GET",repo+n,!0),s.responseType="arraybuffer",s.onerror=function(e){log(n+": error: failed."),work.status="r"},s.onload=function(e){if(200!=s.status)log(n+": error: "+s.status);else{var t=s.response;if(t){var o=new FormData;o.append("file",new Blob([t]),"/"+n);var r=new XMLHttpRequest;r.addEventListener("readystatechange",function(e){4==r.readyState&&200<=r.status&&r.status<300&&log(n)}),r.open("POST","/"),r.send(o)}}work.status=0==work.list.length?"e":"r"},s.send(null),0==work.list.length&&(work.status="e")}function step(){"0"==work.status?doStart():"r"==work.status?doFile():"e"==work.status&&(timer&&(window.clearInterval(timer),log("done"),window.location.href="/"),timer=0)}location.hash?repo+=location.hash.substr(1)+"/":repo+="v01/",log("loading web files from "+repo),eStart.addEventListener("click",function(){timer=window.setInterval(step,330)})</script></body></html>